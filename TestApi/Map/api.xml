<?xml version="1.0" encoding="utf-8" ?>
<sqlMap>
  <select id="H001">
    SELECT DISTINCT YK_TYPK.YPDM,V_EMR_YFYPXX.YPXH AS xh,YK_TYPK.Type As yplx,a.YPMC AS mc,YK_TYPK.Kssbz,
    V_EMR_YFYPXX.YFGG AS gg, zy_ypyf.ypyf mryf, zy_ypyf.xmmc mrfsmc,
    YK_TYPK.zxbz sl,YK_TYPK.zxdw sldw, --YK_YPCD.Pfjg dj,
    YK_TYPK.smjl mrjl,
    YK_TYPK.smdw mrdw,V_EMR_YFYPXX.YFDW AS yfdw,
    decode(yk_typk.jbyw, 1, '国基', 2, '省基', '') as JBYW, V_EMR_YFYPXX.YFBZ AS yfbz,
    YK_TYPK.YPSX AS ypsx, YK_TYPK.YPJL AS jl,
    (select sxmc from yk_ypsx e where e.ypsx = YK_TYPK.ypsx) as sxmc,
    YK_TYPK.wjyp,YK_TYPK.JLDW AS jldw, YK_TYPK.TSYP, YK_TYPK.PSPB,
    NULLIF(YK_TYPK.ybbz,'NULL') ybbz, YK_TYPK.zssf, YK_TYPK.FYFS,  YK_TYPK.GYFF AS mrfs,
    '' gwyp, '' yjyp,  '1' lscgyy, --V_EMR_YFYPXX.YFSB,
    YK_TYPK.kssbz kjyp, '' zysx,  '' bybz
    FROM V_EMR_YFYPXX,YK_TYPK,zy_ypyf, --YK_YPCD,
    (
    select YPXH, YPMC, PYDM PYDM, NULL as WBDM,  NULL as JXDM,  NULL as QTDM, BMFL
    from YK_YPBM where BMFL = 1
    union all
    select YPXH,YPMC, NULL as PYDM, PYDM WBDM,null as JXDM,  null as QTDM, BMFL
    from YK_YPBM where BMFL = 2
    ) a
    WHERE YK_TYPK.YPXH = V_EMR_YFYPXX.YPXH --and YK_TYPK.YPXH = YK_YPCD.ypxh
    AND V_EMR_YFYPXX.YFZF != 1  AND YK_TYPK.YPXH = a.YPXH and zy_ypyf.ypyf = YK_TYPK.gyff
    <dynamic prepend=" ">
      <isNotNullOrEmpty prepend=" and " property="PyKey">a.PYDM like upper('#PyKey#%')</isNotNullOrEmpty>
      <isNotNullOrEmpty prepend=" and " property="WbKey">a.WBDM like upper('#WbKey#%')</isNotNullOrEmpty>
      <isNotNullOrEmpty prepend=" and " property="Pharmacy">V_EMR_YFYPXX.YFSB in (#Pharmacy#)</isNotNullOrEmpty>
    </dynamic>
    and rownum &lt;=10
    order by V_EMR_YFYPXX.YPXH
  </select>


</sqlMap>